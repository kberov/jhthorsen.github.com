#!/bin/sh

echo "### touchpad, trackpoint, touchscreen"

sudo mkdir /etc/X11/xorg.conf.d;
curl -L http://thorsen.pm/attachments/xorg-thinkpad-x240.txt \
  | sudo tee /etc/X11/xorg.conf.d/50-thinkpad-x240.conf;

echo "### wireless"
echo 'HOOK_BLACKLIST="wireless"' | sudo tee -a /etc/pm/config.d/blacklist;

echo "### power"
curl -L http://thorsen.pm/attachments/power-d-thinkpad-x240.txt \
  | /usr/lib/pm-utils/power.d/thinkpad-x240

chmod +x /usr/lib/pm-utils/power.d/thinkpad-x240

echo "### touchscreen"
echo 0000:00:1d.0 | sudo tee /sys/bus/pci/drivers/ehci-pci/unbind;

echo "### brightness"
sudo perl -pi -e's/^(GRUB_CMDLINE_LINUX_DEFAULT)=.*/$1="quiet splash acpi_backlight=vendor"/' /etc/default/grub
sudo update-grub
